<template name="tradesCreate">
  {{#autoForm collection='Trades' id='insertTradeForm' type='insert'}}
    <h1 class="text-center" id="companyPrice" style="margin-top: 0">
      <strong>{{formatNumber companyPrice}}</strong> <small>{{mainCurrency}}</small>
    </h1>
    <div class="progress" style="height: 5px; margin-bottom: 35px">
      <div class="progress-bar" role="progressbar" aria-valuenow="{{percentageLeft}}" aria-valuemin="0" aria-valuemax="100" style="width: {{percentageLeft}}%;">
        <span class="sr-only">{{percentageLeft}}% Complete</span>
      </div>
    </div>
    <div class="row">
      <div class="col-md-5">
        <div class="form-group form-group-lg {{#if afFieldIsInvalid name='memberAmount'}}has-error{{/if}}">
          <div class="input-group input-group-lg">
            {{> afFieldInput name='memberAmount' value=memberAmount class='form-control' autofocus=''}}
            <span class="input-group-addon">{{memberCurrency}}</span>
          </div>
        </div>
        <div class="form-group form-group-lg {{#if afFieldIsInvalid name='memberPaymentMethod'}}has-error{{/if}}">
          {{> afFieldInput name='memberPaymentMethod' value=memberPaymentMethod class='form-control input-lg'}}
        </div>
      </div>
      <div class="col-md-2">
        <button type="button" class="btn btn-default btn-lg center-block" id="switchCurrencies" style="margin-top: 30px; margin-bottom: 30px">
          <i class="fa fa-exchange fa-lg"></i>
        </button>
      </div>
      <div class="col-md-5">
        <div class="form-group form-group-lg {{#if afFieldIsInvalid name='companyAmount'}}has-error{{/if}}">
          <div class="input-group input-group-lg">
            {{> afFieldInput name='companyAmount' value=companyAmount class='form-control' step='0.0001'}}
            <span class="input-group-addon">{{companyCurrency}}</span>
          </div>
        </div>
        <div class="form-group form-group-lg {{#if afFieldIsInvalid name='companyPaymentMethod'}}has-error{{/if}}">
          {{> afFieldInput name='companyPaymentMethod' value=companyPaymentMethod class='form-control input-lg'}}
        </div>
      </div>
    </div>
    {{#if showReceipt}}
    <hr>
    <div class="row">
      <div class="col-xs-8 col-md-4 col-md-offset-2 col-lg-4 col-lg-offset-3">
        <p class="lead">
          {{formatCompanyCurrency companyAmount}}
          <small>× {{companyPrice}} {{mainCurrency}} / BTC</small>
        </p>
      </div>
      <div class="col-xs-4 col-md-4 col-lg-2">
        <p class="lead text-right">
          {{formatMemberCurrency memberAmountSubtotal}}
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-8 col-md-4 col-md-offset-2 col-lg-3 col-lg-offset-3">
        <p class="lead">
          Flat fee
        </p>
      </div>
      <div class="col-xs-4 col-md-4 col-lg-3">
        <p class="lead text-right">
          {{formatMainCurrency flatFee}}
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-8 col-md-4 col-md-offset-2 col-lg-3 col-lg-offset-3">
        <p class="lead">
          GST / QST
        </p>
      </div>
      <div class="col-xs-4 col-md-4 col-lg-3">
        <p class="lead text-right">
          {{formatMainCurrency salesTax}}
        </p>
      </div>
    </div>
    {{#if memberPaymentMethodFee}}
      <div class="row">
        <div class="col-xs-8 col-md-4 col-md-offset-2 col-lg-3 col-lg-offset-3">
          <p class="lead">
            {{memberPaymentMethodName}} fee
            <small>({{memberPaymentMethodPercentageFee}}%)</small>
          </p>
        </div>
        <div class="col-xs-4 col-md-4 col-lg-3">
          <p class="lead text-right">
            {{formatMemberCurrency memberPaymentMethodFee}}
          </p>
        </div>
      </div>
    {{/if}}
    <div class="row">
      <div class="col-xs-6 col-md-4 col-md-offset-2 col-lg-3 col-lg-offset-3">
        <h3>
          <strong>Total</strong>
        </h3>
      </div>
      <div class="col-xs-6 col-md-4 col-lg-3">
        <h3 class="text-right">
          <strong>{{formatMemberCurrency memberAmount}}</strong>
        </h3>
      </div>
    </div>
    <hr>
    <h3 class="text-center">
      {{formatCompanyCurrency companyAmount}} ≈ {{formatMemberCurrency marketValue}} ≈ X USD
    </h3>
    <p class="lead text-center">
      <small>*according to Coinbase</small>
    </p>
    {{/if}}
    {{#if currentUser}}
      <hr>
      <div class="row">
        <div class="col-lg-5">
          <div class="form-group form-group-lg {{#if afFieldIsInvalid name='memberNumber'}}has-error{{/if}}">
            <div class="input-group input-group-lg">
              {{> afFieldInput name='memberNumber' class='form-control'}}
              <span class="input-group-btn">
                <button class="btn btn-default" id="findMember" type="button">Confirm</button>
              </span>
            </div>
          </div>
        </div>
        <div class="col-lg-2">
          <button type="button" class="btn btn-default btn-lg center-block" id="addNewUser">
            <i class="fa fa-user-plus fa-lg"></i>
          </button>
        </div>
        <div class="col-lg-5">
          {{#if memberFound}}
          <div class="form-group form-group-lg">
            <button type="submit" class="btn btn-primary btn-lg btn-block">Submit Trade</button>
          </div>
          {{/if}}
        </div>
      </div>
    {{/if}}
  {{/autoForm}}
  {{#autoForm collection='Members' id='insertUserForm' type='insert'}}
    <!-- <h1>test</h1> -->
  {{/autoForm}}
</template>
